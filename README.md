# Telegram Бот для форматирования документов по ГОСТ

Telegram бот для автоматического форматирования документов Word (.docx) в соответствии с требованиями ГОСТ.

## Возможности

- Автоматическое форматирование документов Word по ГОСТ
- Настройка полей (левое 30мм, правое 10мм, верхнее/нижнее 20мм)
- Форматирование шрифта (Times New Roman, 14pt)
- Междустрочный интервал 1.5
- Красная строка 1.25см
- Выравнивание текста по ширине
- Форматирование заголовков
- Обработка списков
- Нумерация страниц
- Подписи к таблицам и рисункам
- Форматирование библиографического списка
- Генерация оглавления

## Архитектура проекта

```
Telegram-bot/
├── app/
│   ├── config/
│   │   └── settings.py          # Конфигурация приложения
│   ├── handlers/
│   │   ├── command_handler.py   # Обработчики команд (/start, /help)
│   │   └── document_handler.py  # Обработчик документов
│   ├── services/
│   │   └── formatter.py         # Сервис форматирования документов
│   └── utils/
│       ├── logger.py            # Настройка логирования
│       └── file_manager.py      # Управление файлами
├── logs/                         # Логи приложения (создается автоматически)
├── temp/                         # Временные файлы (создается автоматически)
├── main.py                       # Точка входа в приложение
├── requirements.txt              # Зависимости проекта
├── .env                          # Переменные окружения (не для продакшена)
├── .env.example                  # Пример файла с переменными окружения
├── .gitignore                    # Игнорируемые git файлы
└── README.md                     # Документация

```

## Установка

### 1. Клонирование репозитория

```bash
git clone <url-репозитория>
cd Telegram-bot
```

### 2. Создание виртуального окружения

```bash
python -m venv venv
```

### 3. Активация виртуального окружения

**Windows:**
```bash
venv\Scripts\activate
```

**Linux/Mac:**
```bash
source venv/bin/activate
```

### 4. Установка зависимостей

```bash
pip install -r requirements.txt
```

### 5. Настройка переменных окружения

Скопируйте `.env.example` в `.env`:

```bash
cp .env.example .env
```

Откройте `.env` и укажите токен вашего бота:

```env
BOT_TOKEN=ваш_токен_от_BotFather
LOG_LEVEL=INFO
```

#### Как получить токен бота:
1. Найдите [@BotFather](https://t.me/BotFather) в Telegram
2. Отправьте команду `/newbot`
3. Следуйте инструкциям для создания бота
4. Скопируйте полученный токен в `.env`

## Запуск

```bash
python main.py
```

После успешного запуска вы увидите сообщение:
```
==================================================
   Бот успешно запущен!
==================================================
```

## Использование

1. Найдите вашего бота в Telegram
2. Отправьте команду `/start`
3. Отправьте боту файл `.docx`
4. Дождитесь обработки (обычно 10-30 секунд)
5. Получите отформатированный документ

### Доступные команды

- `/start` - Начать работу с ботом
- `/help` - Показать справку

## Требования к документам

- Формат файла: `.docx`
- Максимальный размер: 50 МБ
- Документ не должен быть поврежден

## Настройки форматирования по ГОСТ

Все настройки форматирования находятся в `app/config/settings.py`:

- **Шрифт:** Times New Roman, 14pt
- **Междустрочный интервал:** 1.5
- **Поля:**
  - Левое: 30 мм
  - Правое: 10 мм
  - Верхнее: 20 мм
  - Нижнее: 20 мм
- **Красная строка:** 1.25 см
- **Выравнивание:** по ширине

## Разработка

### Структура приложения

#### `app/config/`
Конфигурация приложения, настройки ГОСТ, переменные окружения.

#### `app/handlers/`
Обработчики команд и сообщений Telegram бота.

#### `app/services/`
Бизнес-логика приложения, включая форматирование документов.

#### `app/utils/`
Вспомогательные утилиты: логирование, управление файлами.

### Логирование

Логи сохраняются в:
- Консоль (уровень INFO)
- Файл `logs/bot.log` (уровень DEBUG)

Уровень логирования можно настроить в `.env`:

```env
LOG_LEVEL=DEBUG  # DEBUG, INFO, WARNING, ERROR, CRITICAL
```

## Обновление зависимостей

```bash
pip install --upgrade -r requirements.txt
```

## Устранение неполадок

### Ошибка: "BOT_TOKEN не установлен"

Убедитесь, что:
- Файл `.env` существует в корне проекта
- В `.env` указан правильный токен бота
- Формат: `BOT_TOKEN=ваш_токен`

### Ошибка при обработке документа

Проверьте:
- Файл имеет расширение `.docx`
- Документ не поврежден
- Размер файла не превышает 50 МБ

### Бот не отвечает

1. Проверьте, что бот запущен
2. Убедитесь в правильности токена
3. Проверьте логи в `logs/bot.log`

## Контакты

При возникновении вопросов или проблем создавайте Issue в репозитории.