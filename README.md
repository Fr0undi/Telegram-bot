# Telegram Бот для форматирования документов по ГОСТ

Telegram бот для автоматического форматирования документов Word (.docx) в соответствии с требованиями ГОСТ.

## Возможности форматирования

### Общее форматирование
- Шрифт Times New Roman, 14pt
- Междустрочный интервал 1.5
- Красная строка 1.25 см
- Выравнивание текста по ширине

### Нумерация страниц
- Нумерация снизу по центру
- Титульный лист считается страницей 1, но номер на нём не отображается
- Если нумерация была сверху - переносится вниз

### Заголовки
- Главные заголовки (СОДЕРЖАНИЕ, ВВЕДЕНИЕ, ЗАКЛЮЧЕНИЕ, ГЛАВА N) - 16pt, жирный, по центру
- Подзаголовки (1.1, 1.2, 2.1 и т.д.) - 14pt, жирный, по центру
- Разрыв страницы перед главными заголовками
- Удаление пустых строк до и после заголовков

### Списки
- Нумерованные списки: шрифт и размер как у основного текста
- Маркированные списки: маркеры сохраняются без изменений
- Автоматическая расстановка знаков препинания (`;` между элементами, `.` в конце)
- Строки с двоеточием не изменяются (вводные фразы)

### Рисунки и таблицы
- Рисунки выравниваются по центру
- Подписи к рисункам: "Рисунок N - Название" по центру
- Подписи к таблицам: "Таблица N - Название"
- Автоматическая нумерация рисунков

### Типографика
- Замена длинных тире (—) на средние (–)
- Унификация кавычек на русские «»
- Добавление неразрывных пробелов (после №, §, перед единицами измерения)
- Удаление множественных пробелов
- Замена сокращений (т.к. -> так как, т.е. -> то есть, и т.д. -> и так далее)

### Библиография
- Форматирование библиографического списка
- Выравнивание по ширине

### Первая страница (титульный лист)
- Первая страница документа НЕ форматируется
- Определяется по разрыву страницы или заголовку "СОДЕРЖАНИЕ"/"ОГЛАВЛЕНИЕ"

## Требования к документу

- Формат файла: `.docx`
- Максимальный размер: 50 МБ
- **1-ая страница должна быть титульным листом**
- Документ не должен быть поврежден или защищен паролем

## После форматирования

После получения отформатированного документа рекомендуется:
1. Проверить рисунки и добавить названия там, где они отсутствуют
2. Проверить корректность разбиения на страницы
3. Убедиться, что все заголовки определены правильно
4. Перепроверить документ перед сдачей

## Архитектура проекта

```
Telegram-bot/
├── app/
│   ├── config/
│   │   └── settings.py          # Конфигурация приложения
│   ├── handlers/
│   │   ├── command_handler.py   # Обработчики команд (/start, /help)
│   │   └── document_handler.py  # Обработчик документов
│   ├── services/
│   │   └── formatter.py         # Сервис форматирования документов
│   └── utils/
│       ├── logger.py            # Настройка логирования
│       └── file_manager.py      # Управление файлами
├── logs/                         # Логи приложения (создается автоматически)
├── temp/                         # Временные файлы (создается автоматически)
├── main.py                       # Точка входа в приложение
├── requirements.txt              # Зависимости проекта
├── .env                          # Переменные окружения (не для продакшена)
├── .env.example                  # Пример файла с переменными окружения
├── .gitignore                    # Игнорируемые git файлы
└── README.md                     # Документация
```

## Установка

### 1. Клонирование репозитория

```bash
git clone <url-репозитория>
cd Telegram-bot
```

### 2. Создание виртуального окружения

```bash
python -m venv venv
```

### 3. Активация виртуального окружения

**Windows:**
```bash
venv\Scripts\activate
```

**Linux/Mac:**
```bash
source venv/bin/activate
```

### 4. Установка зависимостей

```bash
pip install -r requirements.txt
```

### 5. Настройка переменных окружения

Скопируйте `.env.example` в `.env`:

```bash
cp .env.example .env
```

Откройте `.env` и укажите токен вашего бота:

```env
BOT_TOKEN=ваш_токен_от_BotFather
LOG_LEVEL=INFO
```

#### Как получить токен бота:
1. Найдите [@BotFather](https://t.me/BotFather) в Telegram
2. Отправьте команду `/newbot`
3. Следуйте инструкциям для создания бота
4. Скопируйте полученный токен в `.env`

## Запуск

```bash
python main.py
```

После успешного запуска вы увидите сообщение:
```
==================================================
   Бот успешно запущен!
==================================================
```

## Использование

1. Найдите вашего бота в Telegram
2. Отправьте команду `/start`
3. Отправьте боту файл `.docx`
4. Дождитесь обработки (обычно 10-30 секунд)
5. Получите отформатированный документ
6. **Проверьте документ** (особенно рисунки и заголовки)

### Доступные команды

- `/start` - Начать работу с ботом
- `/help` - Показать справку

## Настройки форматирования

Все настройки форматирования находятся в `app/config/settings.py`:

- **Шрифт:** Times New Roman, 14pt
- **Междустрочный интервал:** 1.5
- **Красная строка:** 1.25 см
- **Выравнивание:** по ширине

## Логирование

Логи сохраняются в:
- Консоль (уровень INFO)
- Файл `logs/bot.log` (уровень DEBUG)

Уровень логирования можно настроить в `.env`:

```env
LOG_LEVEL=DEBUG  # DEBUG, INFO, WARNING, ERROR, CRITICAL
```

## Устранение неполадок

### Ошибка: "BOT_TOKEN не установлен"

Убедитесь, что:
- Файл `.env` существует в корне проекта
- В `.env` указан правильный токен бота
- Формат: `BOT_TOKEN=ваш_токен`

### Ошибка при обработке документа

Проверьте:
- Файл имеет расширение `.docx`
- Документ не поврежден
- Размер файла не превышает 50 МБ

### Бот не отвечает

1. Проверьте, что бот запущен
2. Убедитесь в правильности токена
3. Проверьте логи в `logs/bot.log`

## Контакты

При возникновении вопросов или проблем создавайте Issue в репозитории.
