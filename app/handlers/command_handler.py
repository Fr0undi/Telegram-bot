"""Обработчики команд бота"""

from telegram import Update
from telegram.ext import ContextTypes

from app.utils.logger import setup_logger


logger = setup_logger(__name__)


async def start(update: Update, context: ContextTypes.DEFAULT_TYPE) -> None:
    """Обработчик команды /start"""

    welcome_text = """
Добро пожаловать в бота для форматирования документов по ГОСТ!

Отправьте мне файл .docx, и я отформатирую его по стандартам ГОСТ.

Что делает бот:

Текст:
- Шрифт Times New Roman, 14pt
- Междустрочный интервал 1,5
- Красная строка 1,25 см
- Выравнивание по ширине

Заголовки:
- ВВЕДЕНИЕ, ЗАКЛЮЧЕНИЕ, ГЛАВА N - 16pt, жирный, по центру
- Подзаголовки (1.1, 2.1) - 14pt, жирный, по центру
- Разрыв страницы перед главными разделами
- Удаление пустых строк вокруг заголовков

Нумерация страниц:
- Снизу по центру
- Титульный лист = стр. 1, но без видимого номера

Списки:
- Автоматические знаки препинания (; и .)
- Маркеры не изменяются

Рисунки и таблицы:
- Рисунки по центру
- Подписи: "Рисунок N - ..." / "Таблица N - ..."

Типографика:
- Кавычки -> «»
- Длинное тире -> среднее
- Неразрывные пробелы
- Замена сокращений (т.к., т.е., и т.д.)

Требования к файлу:
- 1-ая страница - титульный лист
- Формат .docx

Отправьте документ для обработки!
    """

    await update.message.reply_text(welcome_text)
    logger.info(f"Пользователь {update.effective_user.id} запустил бота")


async def help_command(update: Update, context: ContextTypes.DEFAULT_TYPE) -> None:
    """Обработчик команды /help"""

    help_text = """
Помощь по использованию бота

Команды:
/start - Начать работу с ботом
/help - Показать эту справку

Как использовать:
1. Отправьте боту файл .docx
2. Дождитесь обработки (10-60 сек)
3. Получите отформатированный документ
4. Проверьте результат!

Требования к файлу:
- Формат: .docx (Microsoft Word)
- 1-ая страница - титульный лист
- Максимальный размер: 50 МБ

Что форматируется:

Текст:
- Шрифт: Times New Roman, 14pt
- Интервал: 1,5
- Красная строка: 1,25 см
- Выравнивание по ширине

Заголовки:
- СОДЕРЖАНИЕ, ВВЕДЕНИЕ, ЗАКЛЮЧЕНИЕ, ГЛАВА N - 16pt, жирный, по центру, с новой страницы
- 1.1, 1.2, 2.1 - 14pt, жирный, по центру
- Пустые строки вокруг заголовков удаляются

Нумерация страниц:
- Снизу по центру
- Титульник считается стр.1, но номер не показывается

Списки:
- Нумерованные: шрифт как у текста
- Маркированные: маркеры сохраняются
- Знаки препинания: ; между элементами, . в конце

Рисунки:
- Выравнивание по центру
- Подпись: "Рисунок N - Название"

Таблицы:
- Подпись: "Таблица N - Название"

Типографика:
- Кавычки " " -> « »
- Длинное тире — -> среднее –
- т.к. -> так как, т.е. -> то есть
- и т.д. -> и так далее, и т.п. -> и тому подобное

Что НЕ форматируется:
- Титульный лист (1-ая страница)

После получения файла:
1. Проверьте рисунки - добавьте названия, где их нет
2. Проверьте разбиение на страницы
3. Перепроверьте документ перед сдачей!

Возникли проблемы?
- Убедитесь, что файл .docx не поврежден
- Проверьте, что документ не защищен паролем
    """

    await update.message.reply_text(help_text)
    logger.info(f"Пользователь {update.effective_user.id} запросил помощь")
