"""Обработчики команд бота"""

from telegram import Update
from telegram.ext import ContextTypes

from app.utils.logger import setup_logger


logger = setup_logger(__name__)


async def start(update: Update, context: ContextTypes.DEFAULT_TYPE) -> None:
    """Обработчик команды /start"""

    welcome_text = """
Добро пожаловать в бота для форматирования документов по ГОСТ!

Просто отправьте мне файл формата .docx, и я отформатирую его по стандартам ГОСТ для курсовых работ и рефератов.

Что умеет бот:

Параметры страницы:
  - Поля: левое 30мм, правое 10мм, верх/низ 20мм
  - Формат A4

Текст:
  - Шрифт Times New Roman, 14pt
  - Междустрочный интервал 1,5
  - Красная строка 1,25 см
  - Выравнивание по ширине

Структура документа:
  - Заголовки разделов (ВВЕДЕНИЕ, ЗАКЛЮЧЕНИЕ и др.)
  - Нумерованные заголовки (1. Глава, 1.1 Подраздел)
  - Нумерация страниц снизу по центру
  - Форматирование списков

Специальные элементы:
  - Таблицы с подписями
  - Рисунки с подписями
  - Формулы (текстовые и Office Math)
  - Библиографический список
  - Приложения

Отправьте документ .docx для начала обработки!
    """

    await update.message.reply_text(welcome_text)
    logger.info(f"Пользователь {update.effective_user.id} запустил бота")


async def help_command(update: Update, context: ContextTypes.DEFAULT_TYPE) -> None:
    """Обработчик команды /help"""

    help_text = """
Помощь по использованию бота

Команды:
/start - Начать работу с ботом
/help - Показать эту справку

Как использовать:
1. Отправьте боту файл .docx
2. Дождитесь обработки (10-60 сек)
3. Получите отформатированный документ

Требования к файлу:
- Формат: .docx (Microsoft Word)
- Максимальный размер: 50 МБ

Что форматируется по ГОСТ:

Страница:
- Поля: левое 30мм, правое 10мм, верх/низ 20мм
- Размер: A4 (21x29.7 см)

Текст:
- Шрифт: Times New Roman
- Размер: 14pt (12pt в таблицах)
- Интервал: 1,5 (одинарный в таблицах)
- Красная строка: 1,25 см

Заголовки:
- ВВЕДЕНИЕ, ЗАКЛЮЧЕНИЕ - по центру, жирный
- 1. Глава - по центру, жирный
- 1.1 Подраздел - с красной строки, жирный

Таблицы:
- Подпись сверху: "Таблица 1 - Название"
- Выравнивание по левому краю
- Шрифт внутри: 12pt

Рисунки:
- Подпись снизу: "Рисунок 1 - Название"
- Выравнивание по центру

Формулы:
- По центру с нумерацией справа: (1)
- Поддержка Office Math (OMML)

Библиография:
- Форматирование источников
- Выравнивание по ширине

Приложения:
- Заголовок по центру: "ПРИЛОЖЕНИЕ А"

Возникли проблемы?
- Убедитесь, что файл .docx не поврежден
- Проверьте, что документ не защищен паролем
    """

    await update.message.reply_text(help_text)
    logger.info(f"Пользователь {update.effective_user.id} запросил помощь")
